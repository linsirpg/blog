(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{454:function(s,n,a){"use strict";a.r(n);var e=a(3),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"尺寸单位-rpx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#尺寸单位-rpx"}},[s._v("#")]),s._v(" 尺寸单位 rpx")]),s._v(" "),a("p",[s._v("rpx 可以根据屏幕宽度进行自适应。规定屏幕宽为750rpx。")]),s._v(" "),a("p",[s._v("在所有屏幕上的宽度都为750rpx,所以开发时,无需考虑开发机型,只需根据设计图,然后根据设计图的像(px)素大小,转为rpx开发即可.")]),s._v(" "),a("p",[s._v("例如:")]),s._v(" "),a("ul",[a("li",[s._v("设计图 为750px  则1rpx = 1px")]),s._v(" "),a("li",[s._v("设计图 为1024px 则1rpx = 1.365px")])]),s._v(" "),a("h2",{attrs:{id:"用户登录-获取openid和session-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户登录-获取openid和session-key"}},[s._v("#")]),s._v(" 用户登录,获取OpenID和session_key")]),s._v(" "),a("p",[s._v("1.调用 wx.login() 获取 临时登录凭证code ，并回传到开发者服务器。\n2.调用 auth.code2Session 接口，换取 用户唯一标识 OpenID 和 会话密钥 session_key。")]),s._v(" "),a("p",[s._v("微信小程序开发获取AppID 和 AppSecret")]),s._v(" "),a("ul",[a("li",[s._v("进入https://mp.weixin.qq.com 登录")]),s._v(" "),a("li",[s._v("左侧菜单选择【开发】")]),s._v(" "),a("li",[s._v("右侧tab选择【开发设置】开发者ID")]),s._v(" "),a("li",[s._v("AppSecret栏右侧点击重置\n会弹出一个二维码，需要开发者扫描二维码才可以重置AppSecret\n。出现AppSecret后点击复制，并保存你的AppSecret。\n在保存好之前不要进行任何操作。\n你退出了这个界面且没保存AppSecret，就只能再重新生成AppSecret了。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('1.在生命周期或需要的地方调用\nwx.login({\n  success(res){\n\n    {\n      errMsg: "login:ok", \n      code: "0434Fumk2nPLaC0zBTlk26**********"\n    }\n    // 成功获取code后,发送给后台服务器\n    wx.request({\n      url: "http://wwww.baidu.com/api/loginCode", // 仅为示例，并非真实的接口地址\n      method: "post",\n      data: {\n        code: res\n      },\n      headers: {\n        "content-type": "application/json" // 默认值\n      },\n    })\n  }\n})\n2.后台服务器收到 coed后调用auth.code2Session 接口换取用户唯一标识 OpenID 和 会话密钥 session_key。\n\nNodeJs egg框架 例子\n\nconst result = await this.ctx.curl(\'https://api.weixin.qq.com/sns/jscode2session?appid=APPID&secret=SECRET&js_code=\' + ctx.code.code + \'&grant_type=authorization_code\', {\n  dataType: \'json\',\n});\n通过result.data 可以获取对应的openid和session_key\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("h2",{attrs:{id:"判断是否已经授权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#判断是否已经授权"}},[s._v("#")]),s._v(" 判断是否已经授权")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('wx.getSetting({\n\n  success:function(res){\n\n    if (res.authSetting[\'scope.userInfo\']) {\n\n      console.log("用户授权了");\n\n    } else {\n\n      //用户没有授权\n\n      console.log("用户没有授权");\n\n    }\n\n  }\n})\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h2",{attrs:{id:"授权登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#授权登录"}},[s._v("#")]),s._v(" 授权登录")]),s._v(" "),a("p",[s._v("使用 button 组件，并将 open-type 指定为 getUserInfo 类型，获取用户基本信息。")]),s._v(" "),a("p",[s._v("当用户点击授权时,可以通过bindgetuserinfo事件函数,获取用户的信息")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('<button\n  lang="zh_CN" //注意设置 否则授权拿到的用户地址是中文拼音\n  open-type="getUserInfo"\n  bindgetuserinfo="bindGetUserInfo"\n>登录\n</button>\n\nbindGetUserInfo: function () {\n\n  if(e.mp.detail.userInfo){\n\n    //授权成功\n    可以获取用户的 名称 性别 语言 国家 省份 城市 头像 以及其他数据 \n   \n  } else {\n\n    //授权失败\n  }\n}\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("ul",[a("li",[s._v("lang 的合法值")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("值")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("en")]),s._v(" "),a("td",[s._v("英文")])]),s._v(" "),a("tr",[a("td",[s._v("zh_CN")]),s._v(" "),a("td",[s._v("简体中文")])]),s._v(" "),a("tr",[a("td",[s._v("zh_TW")]),s._v(" "),a("td",[s._v("繁体中文")])])])]),s._v(" "),a("h2",{attrs:{id:"更新小程序到最新版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新小程序到最新版本"}},[s._v("#")]),s._v(" 更新小程序到最新版本")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const updateManager = wx.getUpdateManager();\n\nupdateManager.onCheckForUpdate(function(res) {});\n\nupdateManager.onUpdateReady(function() {\n\n  updateManager.applyUpdate();\n\n});\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"面堆积造成页面卡死问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#面堆积造成页面卡死问题"}},[s._v("#")]),s._v(" 面堆积造成页面卡死问题")]),s._v(" "),a("p",[s._v("小程序中页面栈最多十层,当我们使用navigatorTo进行页面跳转时,如果超过10层,就会造成页面卡死.")]),s._v(" "),a("p",[s._v("注意页面跳转方式的使用:")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("wx.navigateTo")]),s._v(" "),a("p",[s._v("保留当前页面，跳转到应用内的某个页面。但是不能跳到 tabbar 页面。使用 wx.navigateBack 可以返回到原页面。小程序中页面栈最多十层。；")])]),s._v(" "),a("li",[a("p",[s._v("wx.redirectTo")]),s._v(" "),a("p",[s._v("关闭当前页面 ，跳转到应用内的某个页面。但是不允许跳转到 tabbar 页面。；")])]),s._v(" "),a("li",[a("p",[s._v("wx.navigateBack")]),s._v(" "),a("p",[s._v("关闭当前页面，返回上一页面或多级页面。可通过 getCurrentPages() 获取当前的页面栈，决定需要返回几层。 ；")])]),s._v(" "),a("li",[a("p",[s._v("wx.switchTab")]),s._v(" "),a("p",[s._v("跳转到 tabBar 页面，并关闭其他所有非 tabBar 页面；")])]),s._v(" "),a("li",[a("p",[s._v("wx.reLaunch")]),s._v(" "),a("p",[s._v("基础库 1.1.0 开始支持，低版本需做兼容处理。\n关闭所有页面，打开到应用内的某个页面；")]),s._v(" "),a("p",[s._v("最后使用wx.reLaunch解决了页面堆积的问题。")])])]),s._v(" "),a("h2",{attrs:{id:"授权获取手机号码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#授权获取手机号码"}},[s._v("#")]),s._v(" 授权获取手机号码")]),s._v(" "),a("p",[s._v("1、通过wx.login获取code,从而获取到用户的openID和sessionKey")]),s._v(" "),a("p",[s._v("2、通过getPhoneNumber获取encryptedData，iv 发送给后台服务器 再配合用户的的openID和sessionKey 获取用户手机号")]),s._v(" "),a("p",[s._v("3、通过参数【encryptedData】 、【iv】 、【sessionKey】  请求后台解密获取用户手机号")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\n<button \n  class='pop_btn'\n  plain=\"true\"\n  open-type='getPhoneNumber' \n  bindgetphonenumber=\"getPhoneNumber\"\n>获取用户手机号</button>\n\ngetPhoneNumber: function (e) {\n  if (e.mp.detail.errMsg == \"getPhoneNumber:ok\") {\n    //授权成功 获取encryptedData，iv 发送到后台服务器\n    var obj = {\n      encryptedData: e.mp.detail.encryptedData,\n      iv: e.mp.detail.iv\n    };\n  } else {\n    // 用户拒绝授权\n  }\n}\n\nNodeJs egg框架 例子\n\nvar crypto = require('crypto'); // npm install crypto --save-dev 记得下载 crypto 模块\n\nvar session_key = new Buffer('获取的sessionKey', 'base64')\n\nvar appId = '小程序appID'\n\nvar encryptedData = new Buffer('获取的encryptedData', 'base64')\n\nvar iv = new Buffer('获取的iv', 'base64')\n\ntry {\n  // 解密\n  var decipher = crypto.createDecipheriv('aes-128-cbc', session_key, iv)\n\n  // 设置自动 padding 为 true，删除填充补位\n\n  decipher.setAutoPadding(true)\n\n  var decoded = decipher.update(encryptedData', 'binary', 'utf8')\n\n  decoded += decipher.final('utf8')\n\n  decoded = JSON.parse(decoded)\n\n} catch (err) {\n\n  throw new Error('Illegal Buffer')\n\n}\n\nif (decoded.watermark.appid !== appId) {\n  throw new Error('Illegal Buffer')\n}\n\nif (decoded && decoded.phoneNumber) {\n  \x3c!-- 如果为真 获取手机号码成功 --\x3e\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br")])]),a("h2",{attrs:{id:"开发设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发设置"}},[s._v("#")]),s._v(" 开发设置")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("进入https://mp.weixin.qq.com 登录")])]),s._v(" "),a("li",[a("p",[s._v("左侧菜单选择【开发】")])]),s._v(" "),a("li",[a("p",[s._v("右侧tab选择【开发设置】 服务器域名")])]),s._v(" "),a("li",[a("p",[s._v("设置对应的request合法域名 uploadFile合法域名 socket合法域名 downloadFile合法域名 udp合法域名 用到哪个设置哪个(设置的域名要有ssl正式,支持https)")])]),s._v(" "),a("li",[a("p",[s._v("小程序上线必须设置 否则接口请求不成功")])])]),s._v(" "),a("p",[s._v("如果没有设置可以开发时可以取消验证")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("点击开发者工具最右侧的详情")])]),s._v(" "),a("li",[a("p",[s._v("勾上不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书即可")])])])])}),[],!1,null,null,null);n.default=t.exports}}]);